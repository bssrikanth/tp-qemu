- test_snp_params:
    type = test_snp_params
    only Linux
    kill_vm = yes
    login_timeout = 240
    start_vm = no
    image_snapshot = yes
    mem = 2048
    smp = 2
    virtio_dev_iommu_platform = on
    virtio_dev_disable_legacy = on
    bios_path = /usr/share/ovmf/OVMF.fd
    module_status = Y y 1
    vm_secure_guest_type = snp
    vm_sev_reduced_phys_bits = 1
    vm_sev_cbitpos = 51
    cvm_module_path = "/sys/module/kvm_amd/parameters/sev_snp"
    cvm_guest_check = "journalctl | grep -i -w snp"
    vm_sev_policy = 196608
    vm_mem_backend = memory-backend-memfd
    variants:
        - nosnp:
            param_to_check = "sev=nosnp"
            error_pattern = "SEV command-line option 'nosnp' was not recognized"
            vm_boot_expected = no
            host_snp_supported = no
